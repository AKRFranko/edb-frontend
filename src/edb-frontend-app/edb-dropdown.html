<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="edb-dropdown">
  <template>
    <style>
      :host{
        display:block;
        @apply(--layout);
        /*width:100%;*/
        /*height:100%;*/
        @apply(--layout-vertical);
      }
     paper-button#label{
       background:#fff;
       color:#000;
       margin:0;
       padding:1rem 0;
       border-top:1px solid #000;
       border-radius:0;
       font-size: inherit;
       font-style: normal;
       text-transform: none;
       @apply(--layout-justified);
     }
     paper-button iron-icon{
       
       width: 3rem;
       height: 1rem;
     }
     #content{
       height:0;
       min-height:0;
       transition:all .2s ease-in;
       overflow:hidden;
     }
     #content.opened{
       height:auto;
       width:100%;
       padding:20px 0;
       min-height:100%;
     }
    </style>
    
    <paper-button id="label" on-tap="_toggleState">
      {{label}} <iron-icon icon="{{icon}}"></iron-icon>
    </paper-button>
    <div id="content">
      <content></content>
    </div>
    
  </template>
  <script>
     if(!window.EDBDrops){
       window.EDBDrops = {};
     }
      Polymer({
  
        is: 'edb-dropdown',
  
        properties: {
         label: {
           type: String,
           value: 'Select one'
         },
         opened:{
           type: Boolean,
           notify: true,
           value: false
         },
         icon: {
           type: String,
           notify: true,
           computed: '_computeIcon(opened)'
         },
         group: {
           type: String
         }
          
         
        
        },
        observers: ['_openChanged(opened)','_toggleState(opened)'],
        _openChanged: function(){
          if(this.opened){
            this.$.content.classList.remove('opened');  
          }else{
            this.$.content.classList.add('opened');  
          }
          
        },
        _toggleState: function(){
          var newState = !this.get('opened');
          this.set('opened',newState);
          if(this.group && window.EDBDrops[this.group]){
            window.EDBDrops[this.group].forEach( function( item ){
                  item.opened = false;  
            }, this );  
          }
          
        },
        _computeIcon: function( isOpen){
          return isOpen ? 'edb:chevron-down' : 'edb:chevron-up';
        },
        created: function(){
          
          
          if(!this.group) return;
          window.EDBDrops[this.group] = window.EDBDrops[this.group] || [];
          window.EDBDrops[this.group].push(this);
        }
        
     
  
      });
  </script>
</dom-module>